---
import Layout from '../layouts/Layout.astro';
import data from '../data/sitecontent.json';
import { getCollection } from "astro:content";
const newsPosts = await getCollection("news");
const reviewsPosts = await getCollection("reviews");
const guidesPosts = await getCollection("guides");
import functions from '../js/functions.js';

function filterPost(arr) {
	return arr.filter(item => item.data.draft === false);
}

const { index } = Astro.props
const slideAnim = {
  old: {
    name: 'slideDown',
    duration: '0.5s',
    easing: 'ease',
    fillMode: 'backwards',
  },
  new: {
    name: 'slideUp',
    duration: '0.5s',
    delay: `${index * 0.2 + 0.1}s`,
    easing: 'ease',
    fillMode: 'backwards',
  },
}
const verticalSlide = {
  forwards: slideAnim,
  backwards: slideAnim,
}

const res = await fetch('https://pftraveldev.wpengine.com/wp-json/pot/v1/page-meta/1048');
const pageData = await res.json();

console.log(pageData);
---
<Layout title="Welcome to Prince of Travel" description="Prince of Travel" image="/images/video/pc-social-banner.jpeg">
	<!-- https://cdn1.vectorstock.com/i/1000x1000/89/30/a-plane-line-drawing-style-design-vector-30478930.jpg -->
		<div class="container-fluid px-0" data-aos="fade">
			<div class="row min-vh-100">
				<div class="col-lg-8 offset-lg-2 d-flex flex-column justify-content-center align-items-center text-center p-5">
					<img class="logo mb-4 animate-in py-4 ps-4 pe-3 rounded-4" style="width: 100px; background: var(--green)" src="/images/logos/pot-crown-white.png" alt="Prince collection logo" />					
					<!-- <h1 class="fw-bold lh-1 ls-1 mb-1 mt-0 animate-in" style="font-size: 16vmin; font-size: 96px;">{data.home.hero.title}</h1> -->
					<h1 class="fw-bold lh-1 ls-1 mb-1 mt-0 animate-in" style="font-size: 16vmin; font-size: 96px;">Your travel points specialists.</h1>
                    <h2>{pageData.title}</h2>
					<p class="fs-5">{pageData.banner_description}</p>
					<!-- <p class="fs-3 col-lg-8">Be inspired to travel <span class="fw-bold">more,</span> <span class="fw-bold">better,</span> and <span class="fw-bold">cheaper</span> with Prince of Travel's expertise in travel rewards, points programs, credit cards, and accommodation.</p> -->
				</div>
				</div>

				<div class="row min-vh-500">
					<div class="col-lg-12 min-vh-500 p-0">
						<img class="w-100 h-100 object-fit" src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*K33udAYnNTBvaNZY_tM3UQ.jpeg" alt="">
					</div>
				</div>
</Layout>

<script>
	// https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/play
	// astro reinit script in SPA mode w/ astro:page-load => didn't work

	let videoElem = document.getElementById("heroVideo");
	const playIcon = document.getElementById("playIcon");
	const playButton = document.getElementById("playButton");

	let videoLoaded = false;

	function sayHello() {
		var video = document.getElementById('heroVideo');
		var source = document.getElementById('videoSource');
		source.src = "/images/video/pc-hero-video-min.mp4"; // Update the video source
		video.load(); // Load the video
		video.play(); 
		videoLoaded = true;
	}

	function loadVideoOnce() {
		if (!videoLoaded) sayHello();
	}

	[videoElem, playButton].forEach(item => {
		item.addEventListener("click", loadVideoOnce, false);
		// item.addEventListener("click", detectPlay, false);
	});

	videoElem.addEventListener("playing", () => {
		playIcon.classList.remove("bi-play-circle");
		playIcon.classList.add("opacity-25", "bi-pause-circle");
		[videoElem, playButton].forEach(item => {
			item.addEventListener("click", () => { videoElem.pause()});
		})
	});
	videoElem.addEventListener("pause", () => {
		playIcon.classList.remove("opacity-25", "bi-pause-circle");
		playIcon.classList.add("bi-play-circle");
		[videoElem, playButton].forEach(item => {
			item.addEventListener("click", () => { videoElem.play()});
		})
	});

</script>

